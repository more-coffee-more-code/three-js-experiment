<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script async src="https://unpkg.com/es-module-shims@1.8.0/dist/es-module-shims.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
    <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
        }

        p {
          background-color: black;
          color: white;
          font-size: 32px;
          text-align: center;
        }

        .carousel {
          min-width: 110vw;
          height: 100%;
          padding-left: 300px;
          overflow: hidden;
        }

        .carousel-inner {
          display: flex;
          flex-direction: row;
          justify-content: space-between;
          height: 100%;
        }

        .carousel-item {
          min-width: 50vw;
          height: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          font-size: 3rem;
          color: black;
          scroll-snap-align: center;
        }

        .carousel-image {
          max-height: 500px;
        }

        .main-carousel {
          width: 100%;
          height: 200px;
          background-color: black;
          color: white;
          overflow: unset !important;
        }

        .carousel-cell {
          width: 100%;
          height: 100%;
          overflow: unset !important;
        }
        </style>
<script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.156.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.156.0/examples/jsm/"
    }
  }
</script>
    <title>Three JS experiment</title>
</head>
<body>
  <p>Click and drag your mouse in this (<---) direction</p>

  <!-- <div class="main-carousel">
    <div class="carousel-cell">cell 1</div>
    <div class="carousel-cell">cell 2 </div>
    <div class="carousel-cell">cell 3 </div>
  </div> -->
  

  <div class="carousel">
      <div class="carousel-inner">
          <div class="carousel-item">
            <img src="/images/0_2.png" alt="" class="carousel-image">
          </div>
          <div class="carousel-item">Item 2</div>
          <div class="carousel-item">Item 3</div>
          <div class="carousel-item">Item 4</div>
          <div class="carousel-item">Item 5</div>
      </div>
  </div>

  <!-- <script type="module" src="main.js"></script> -->
  <script>
   const carousel = document.querySelector('.carousel');
const carouselInner = document.querySelector('.carousel-inner');
const cells = document.querySelectorAll('.carousel-cell');
const images = [
  'images/0_2.png',
  'images/0_3.png',
  'images/0_4.png',
  'images/0_5.png',
  'images/0_6.png',
  'images/0_7.png',
  'images/0_8.png',
  'images/0_9.png',
  'images/0_10.png',
  'images/0_11.png',
  'images/0_12.png',
  'images/0_13.png',
  'images/0_14.png',
  'images/0_15.png',
  'images/0_16.png',
  'images/0_17.png',
  'images/0_18.png',
  'images/0_19.png',
  'images/0_20.png',
  'images/0_21.png',
  'images/0_22.png',
  'images/0_23.png',
  'images/0_24.png',
  'images/0_25.png',
  'images/0_26.png',
  'images/0_27.png',
  'images/0_28.png',
  'images/0_29.png',
  'images/0_30.png',
  'images/0_31.png',
  'images/0_32.png',
  'images/0_33.png',
];
let currentIndex = 0;
let startPosition = 0;
let currentTranslate = 0;
let isDragging = false;

function setPositionByIndex() {
  const currentTranslate = currentIndex * -100;
  carouselInner.style.transform = `translateX(${currentTranslate}%)`;
}

function setImageByIndex() {
  const imageIndex = Math.floor(currentTranslate / -2);
  const image = images[imageIndex + 1];
  const imageElement = document.querySelector('.carousel-image');
  if (image) {
    imageElement.src = image;
  } else {
    imageElement.src = '';
  }
}

carouselInner.addEventListener('mousedown', e => {
  e.preventDefault();
  isDragging = true;
  startPosition = e.clientX;
  carouselInner.style.cursor = 'grabbing';
});

carouselInner.addEventListener('mouseup', e => {
  isDragging = false;
  carouselInner.style.cursor = 'grab';
  currentTranslate = currentIndex * -100;
  carouselInner.style.transform = `translateX(${currentTranslate}%)`;
  const movedBy = e.clientX - startPosition;
  if (movedBy < -100 && currentIndex < cells.length - 1) {
    currentIndex += 1;
  } else if (movedBy > 100 && currentIndex > 0) {
    currentIndex -= 1;
  }
  setPositionByIndex();
  setImageByIndex();
});

carouselInner.addEventListener('mousemove', e => {
  if (isDragging) {
    const currentPosition = e.clientX;
    const movedBy = currentPosition - startPosition;
    currentTranslate = currentIndex * -100 + (movedBy / carouselInner.offsetWidth) * 100;
    carouselInner.style.transform = `translateX(${currentTranslate}%)`;
    setImageByIndex();
  }
});

carousel.addEventListener('scroll', () => {
  currentIndex = Math.round(carousel.scrollLeft / carousel.offsetWidth);
});

setPositionByIndex();
setImageByIndex();

// var elem = document.querySelector('.main-carousel');
// var flkty = new Flickity( elem, {
//   // options
// });

// // element argument can be a selector string
// //   for an individual element
// var flkty = new Flickity( '.main-carousel', {
//   // options
// });
</script>
</body>
</html>